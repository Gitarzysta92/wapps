# Main dnsmasq configuration
# Generated by Ansible - do not edit manually

# Bind to loopback interface only
listen-address=127.0.0.1

# Use port 5354 to avoid conflict with systemd-resolved and mDNS
port=5354

# Enable logging
log-queries
log-dhcp
log-facility=/var/log/dnsmasq.log

# Only handle {{ target_env }}.wapps.com domain and subdomains
# This will resolve ANY subdomain to the specified IP
address=/{{ target_env }}.wapps.com/{{ target_ip }}
address=/*.{{ target_env }}.wapps.com/{{ target_ip }}

# Forward other queries to upstream DNS
no-resolv
server=1.1.1.1
server=9.9.9.9

# Cache settings
cache-size=1000
neg-ttl=3600

# Don't read /etc/hosts
no-hosts
