# dnsmasq loopback configuration for {{ target_env }} environment
# Generated by Ansible - do not edit manually

bind-dynamic

# Use port 5353 to avoid conflict with systemd-resolved
port=5353

# Enable logging
log-queries
log-dhcp

# Only handle {{ target_env }}.wapps.com domain and subdomains
# This will resolve ANY subdomain to the specified IP
address=/{{ target_env }}.wapps.com/{{ target_ip }}
address=/*.{{ target_env }}.wapps.com/{{ target_ip }}

# Forward other queries to upstream DNS
no-resolv
server=1.1.1.1
server=9.9.9.9

# Cache settings
cache-size=1000
neg-ttl=3600

# Don't read /etc/hosts
no-hosts
