<div class="news-feed-container" appInfiniteScroll (scrolledToBottom)="onScrolledToBottom()">
  @if (useInfiniteScroll) {
    <!-- Infinite Scroll Mode -->
    <div class="feed-header">
      <h2>News Feed</h2>
      <button 
        tuiButton 
        type="button" 
        size="s"
        (click)="refresh()" 
        [disabled]="loading$ | async">
        <tui-icon icon="tuiIconRefresh2"></tui-icon>
        Refresh
      </button>
    </div>
    
    @if ((feedItems$ | async)?.length === 0 && !(loading$ | async)) {
      <div class="empty-feed">
        <p>No news items to display. Feed items will appear here when available.</p>
      </div>
    } @else {
      <div class="feed-items">
        @for (item of feedItems$ | async; track item.id) {
          @switch (item.type) {
            @case (FeedItemType.ARTICLE_HIGHLIGHT) {
              <article-highlight-feed-item [item]="item"></article-highlight-feed-item>
            }
            @case (FeedItemType.APPLICATION_HEALTH) {
              <application-health-feed-item [item]="item"></application-health-feed-item>
            }
            @default {
              <div class="unknown-feed-item">
                <p>Unknown feed item type: {{ item.type }}</p>
              </div>
            }
          }
        }
      </div>
      
      @if (loading$ | async) {
        <div class="loading-indicator">
          <tui-loader size="s"></tui-loader>
          <p>Loading more items...</p>
        </div>
      }
      
      @if (!(hasMore$ | async) && (feedItems$ | async) && (feedItems$ | async)!.length > 0) {
        <div class="end-of-feed">
          <p>You've reached the end of the feed</p>
        </div>
      }
    }
  } @else {
    <!-- Static Mode -->
    @if (feedItems.length === 0) {
      <div class="empty-feed">
        <p>No news items to display. Feed items will appear here when available.</p>
      </div>
    } @else {
      <div class="feed-items">
        @for (item of feedItems; track item.id) {
          @switch (item.type) {
            @case (FeedItemType.ARTICLE_HIGHLIGHT) {
              <article-highlight-feed-item [item]="item"></article-highlight-feed-item>
            }
            @case (FeedItemType.APPLICATION_HEALTH) {
              <application-health-feed-item [item]="item"></application-health-feed-item>
            }
            @default {
              <div class="unknown-feed-item">
                <p>Unknown feed item type: {{ item.type }}</p>
              </div>
            }
          }
        }
      </div>
    }
  }
</div>
