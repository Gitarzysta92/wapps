<div class="news-feed-container">
  @if (useInfiniteScroll) {
    <!-- Infinite Scroll Mode -->
    <div class="feed-header">
      <h2>News Feed</h2>
      <button class="refresh-btn" (click)="refresh()" [disabled]="loading$ | async">
        ðŸ”„ Refresh
      </button>
    </div>
    
    <div 
      class="feed-scroll-container" 
      infiniteScroll 
      [disabled]="!(hasMore$ | async) || (loading$ | async)"
      (scrolled)="onScroll()">
      
      @if ((feedItems$ | async)?.length === 0 && !(loading$ | async)) {
        <div class="empty-feed">
          <p>No news items to display. Feed items will appear here when available.</p>
        </div>
      } @else {
        <div class="feed-items">
          @for (item of feedItems$ | async; track item.id) {
            @switch (item.type) {
              @case (FeedItemType.ARTICLE_HIGHLIGHT) {
                <article-highlight-feed-item [item]="item"></article-highlight-feed-item>
              }
              @case (FeedItemType.APPLICATION_HEALTH) {
                <application-health-feed-item [item]="item"></application-health-feed-item>
              }
              @default {
                <div class="unknown-feed-item">
                  <p>Unknown feed item type: {{ item.type }}</p>
                </div>
              }
            }
          }
        </div>
        
        @if (loading$ | async) {
          <div class="loading-indicator">
            <div class="spinner"></div>
            <p>Loading more items...</p>
          </div>
        }
        
        @if (!(hasMore$ | async) && (feedItems$ | async) && (feedItems$ | async)!.length > 0) {
          <div class="end-of-feed">
            <p>You've reached the end of the feed</p>
          </div>
        }
      }
    </div>
  } @else {
    <!-- Static Mode -->
    @if (feedItems.length === 0) {
      <div class="empty-feed">
        <p>No news items to display. Feed items will appear here when available.</p>
      </div>
    } @else {
      <div class="feed-items">
        @for (item of feedItems; track item.id) {
          @switch (item.type) {
            @case (FeedItemType.ARTICLE_HIGHLIGHT) {
              <article-highlight-feed-item [item]="item"></article-highlight-feed-item>
            }
            @case (FeedItemType.APPLICATION_HEALTH) {
              <application-health-feed-item [item]="item"></application-health-feed-item>
            }
            @default {
              <div class="unknown-feed-item">
                <p>Unknown feed item type: {{ item.type }}</p>
              </div>
            }
          }
        }
      </div>
    }
  }
</div>
