<div class="news-feed-container" appInfiniteScroll (scrolledToBottom)="onScrolledToBottom()">
  @if ((feedItems$ | async)?.length === 0 && !(loading$ | async)) {
    <div class="empty-feed">
      <p>No news items to display. Feed items will appear here when available.</p>
    </div>
  } @else {
    <div class="feed-items">
      @for (item of feedItems$ | async; track item.id) {
        @if (itemTemplate) {
          <ng-container [ngTemplateOutlet]="itemTemplate" [ngTemplateOutletContext]="{ $implicit: item }"></ng-container>
        } @else {
          @switch (item.type) {
            @case (FeedItemType.ARTICLE_HIGHLIGHT) {
              <article-highlight-feed-item [item]="item"></article-highlight-feed-item>
            }
            @case (FeedItemType.APPLICATION_HEALTH) {
              <application-health-feed-item [item]="item"></application-health-feed-item>
            }
            @default {
              <div class="unknown-feed-item">
                <p>Unknown feed item type: {{ item.type }}</p>
              </div>
            }
          }
        }
      }
    </div>
    
    @if (loading$ | async) {
      <div class="loading-indicator">
        <tui-loader size="s"></tui-loader>
        <p>Loading more items...</p>
      </div>
    }
    
    @if (!(hasMore$ | async) && (feedItems$ | async) && (feedItems$ | async)!.length > 0) {
      <div class="end-of-feed">
        <p>You've reached the end of the feed</p>
      </div>
    }
  }
</div>
