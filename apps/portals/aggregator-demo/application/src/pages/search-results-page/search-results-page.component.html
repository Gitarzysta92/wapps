<section class="section__filters">
  <filters-bar></filters-bar>
</section>

<section class="section__separator"></section>

<div class="results-header-global">
  <h2>Search Results ({{ paginationService.totalLoadedItems }} items)</h2>
  <button tuiButton appearance="secondary" (click)="paginationService.loadNextPage()">
    Load More
  </button>
</div>

<div *ngIf="paginationService.canLoadPrevious" class="load-more-container load-more-top">
  <button tuiButton appearance="secondary" (click)="paginationService.loadPreviousPage()">
    Load Previous Page
  </button>
</div>

<ng-container *ngFor="let pageData of paginationService.allLoadedItems; let isFirst = first; let isLast = last">    
  <ng-container *ngFor="let group of pageData.data.groups">
    <section class="section__results">
      <div class="group-header">
        <h3 [ngSwitch]="group.type">
          <ng-container *ngSwitchCase="DiscoverySearchResultType.Article">Articles</ng-container>
          <ng-container *ngSwitchCase="DiscoverySearchResultType.Suite">Suites</ng-container>
          <ng-container *ngSwitchCase="DiscoverySearchResultType.Application">Applications</ng-container>
        </h3>
        <span class="group-count">{{ group.entries.length }} items</span>
      </div>
      
      <div class="items-grid">
        <div *ngFor="let entry of group.entries" class="item-card">
          <h4>{{ entry.name }}</h4>
          <div class="item-meta">
            <ng-container [ngSwitch]="group.type">
              <ng-container *ngSwitchCase="DiscoverySearchResultType.Article">
                <span class="type-badge">Article</span>
                <span>by {{ asArticle(entry).authorName }}</span>
                <span>ðŸ’¬ {{ entry.commentsNumber }}</span>
              </ng-container>
              <ng-container *ngSwitchCase="DiscoverySearchResultType.Suite">
                <span class="type-badge">Suite</span>
                <span>{{ asSuite(entry).numberOfApps }} apps</span>
                <span>by {{ asSuite(entry).authorName }}</span>
                <span>ðŸ’¬ {{ entry.commentsNumber }}</span>
              </ng-container>
              <ng-container *ngSwitchCase="DiscoverySearchResultType.Application">
                <span class="type-badge">Application</span>
                <span class="category">{{ asApplication(entry).category.name }}</span>
                <span class="rating">â˜… {{ asApplication(entry).rating.toFixed(1) }}</span>
                <span>ðŸ’¬ {{ entry.commentsNumber }}</span>
              </ng-container>
            </ng-container>
          </div>
        </div>
      </div>
    </section>
  </ng-container>
</ng-container>
